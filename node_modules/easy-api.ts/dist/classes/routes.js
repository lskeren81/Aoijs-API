"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Endpoints=void 0;const tslib_1=require("tslib"),fs_1=require("fs"),path_1=require("path"),utils_1=require("./utils"),safe_1=tslib_1.__importDefault(require("colors/safe"));class Endpoints{app;routes;constructor(t){this.app=t,this.routes=[]}getRoutes(){return this.routes}add(t){if(!t)throw new SyntaxError("Invalid route data provided.");if(!t.path||"string"!=typeof t.path)throw new SyntaxError("Invalid path route provided.");if(!t.code||"string"!=typeof t.path)throw new SyntaxError("Invalid call string provided.");if(t.details&&"object"!=typeof t.details)throw new SyntaxError("Invalid extra object provided.");this.routes[this.routes.length]=t}async loadWithCache(t,e){var a=process.cwd();for(const r of(0,fs_1.readdirSync)((0,path_1.join)(a,t)))if((0,fs_1.lstatSync)((0,path_1.join)(a,t,r)).isDirectory())this.loadWithCache((0,path_1.join)(t,r),e);else try{var o=require((0,path_1.join)(a,t,r));(o=!o?.path&&o?.default?.path?o.default:o)?.path&&o?.code?(this.add(o),e.push({path:(0,path_1.join)(a,t,r),loaded:safe_1.default.green("Loaded"),route:o.path})):e.push({path:(0,path_1.join)(a,t,r),loaded:safe_1.default.red("Failed"),route:o?.path})}catch(o){console.log(o),e.push({path:(0,path_1.join)(a,t,r),loaded:safe_1.default.red("Failed")})}}async load(e){if(!e||"string"!=typeof e)throw new SyntaxError("Invalid path provided.");let a=[],o="| ----------------------------------------------------- |";this.loadWithCache(e,a).then(()=>{a=a.map(t=>`| ${safe_1.default.grey(t.path)}
| ${t.loaded} [${safe_1.default.cyan(t.route||"Unknown route")}]
`+o),console.log(o);for(const t of a)console.log(t)}).catch(t=>{utils_1.Utils.Warn(`Failed to load path with reason: ${t}. at:`,`load(${e})`)})}}exports.Endpoints=Endpoints;