"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.data=void 0;const builder_1=require("../classes/builder"),utils_1=require("../classes/utils");exports.data={data:(new builder_1.FunctionBuilder).setName("send").setValue("description","Send something to the request.").setValue("use","$send[status;type(json/safe/canvas/file/redirect/other);body]").setValue("returns","Void"),code:async e=>{if(await e.func?.resolve_fields(e),!e.func?.inside)return utils_1.Utils.Warn("Invalid inside provided in:",e.func?.name);if(e.func.fields.length<3)return utils_1.Utils.Warn("Invalid fields provided in:",e.func.name);var[s,t,n,a]=e.func.fields.map(({value:e})=>e);if(!utils_1.Utils.isNumber(s))return utils_1.Utils.Warn("Invalid status provided in:",e.func.name);if("json"===t.toLowerCase()){var r=utils_1.Utils.loadObject(n.unescape());if(!r)return utils_1.Utils.Warn("Invalid JSON provided in:",e.func.name);e.res.status(parseInt(s)).json(r)}else if("safe"===t.toLowerCase()){if(!(r=e._.object))return utils_1.Utils.Warn("No object was found, create one first. In:",e.func.name);r=JSON.parse(JSON.stringify(r).unescape()),e.res.status(parseInt(s)).json(r)}else if("canvas"===t.toLowerCase()){if(!(r=e._.Canvas?.canvas))return utils_1.Utils.Warn("No canvas was found, create one first. In:",e.func.name);e.res.set("Content-Type",a||"image/png"),e.res.status(parseInt(s)).send(r.toBuffer(a||"image/png"))}else"file"===t.toLowerCase()?e.res.status(parseInt(s)).sendFile(n.unescape()):"other"===t.toLowerCase()?e.res.status(parseInt(s)).send(n.unescape()):"redirect"===t.toLowerCase()&&e.res.redirect(n.unescape());return{code:e.code.replace(e.func.id,"")}}};